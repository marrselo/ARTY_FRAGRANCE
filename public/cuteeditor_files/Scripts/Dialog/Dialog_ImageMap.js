var OxO1dde=["contains","parentNode","selection","document","type","None","Text","body","rangeCount","window","Control","anchorOffset","childNodes","anchorNode","isCollapsed","focusNode","length","nodeType","nodeName","INPUT","TEXTAREA","BUTTON","IMG","SELECT","TABLE","position","style","absolute","relative","top","contentWindow","contentDocument","parentWindow","id","frames","frameElement","//TODO:frame contentWindow not found?","iframe","editor","img","onload","src","","src_cetemp","contentEditable","designMode","on","clearAttributes","marginTop","0","marginLeft","color","black","background","white","unselectable","2D-Position","LiveResize","innerHTML","outerHTML","MAP","name","useMap","#","areas","href","target","alt","coords",",","\x3Cimg id=\x27myIMAGE","\x27 border=1 src=\x27Images/space.gif\x27 title=\x27","\x27 style=\x27position:absolute;left:","px;top:","px;width:","px;height:","px;z-index:","\x27\x3E","MapLink.php","dialogWidth:380px;dialogHeight:200px;help:no;scroll:no;status:no;resizable:0;","zoom","width","height","\x27  border=1 src=\x27Images/space.gif\x27 title=\x27","\x27 style=\x27position:absolute;z-index:",";width:20;height:20;left:",";top:","myIMAGE","\x3Carea shape=\x27rect\x27 coords=\x27","\x27","href=\x27","\x27 ","target=\x27","alt=\x27","\x3E","PasteHTML","\x3Cmap name=\x27","\x3C/map\x3E","off","AutoMap","display","img_zoom_in","none","img_zoom_out","img_bestfit","img_actualsize"];function Element_Contains(element,Ox2ad){if(!Browser_IsOpera()){if(element[OxO1dde[0]]){return element.contains(Ox2ad);} ;} ;for(;Ox2ad!=null;Ox2ad=Ox2ad[OxO1dde[1]]){if(element==Ox2ad){return true;} ;} ;return false;} ;function Window_CreateSelectionRange(Ox2d4){var Ox353;if(Browser_UseIESelection()){var Ox26a=Ox2d4[OxO1dde[3]][OxO1dde[2]];if(Ox26a[OxO1dde[4]]==OxO1dde[5]||Ox26a[OxO1dde[4]]==OxO1dde[6]){Ox353=Ox26a.createRange();} else {Ox353=document[OxO1dde[7]].createTextRange();Ox353.moveToElement(Ox26a.createRange().item(0));} ;} else {var Ox26a=Ox2d4.getSelection();if(Ox26a[OxO1dde[8]]==0){Ox353=Ox2d4[OxO1dde[3]].createRange();} else {Ox353=Ox26a.getRangeAt(0).cloneRange();} ;} ;Ox353[OxO1dde[9]]=Ox2d4;return Ox353;} ;function Window_GetSelectionNode(Ox2d4){var Ox2ad=Window_GetSelectionNode_Core(Ox2d4);if(Ox2ad==Ox2d4[OxO1dde[3]][OxO1dde[7]]){return null;} ;if(!Element_Contains(Ox2d4[OxO1dde[3]].body,Ox2ad)){return null;} ;return Ox2ad;} ;function Window_GetSelectionNode_Core(Ox2d4){var Ox26a;if(Browser_UseIESelection()){Ox26a=Ox2d4[OxO1dde[3]][OxO1dde[2]];if(Ox26a[OxO1dde[4]]==OxO1dde[5]||Ox26a[OxO1dde[4]]==OxO1dde[6]){return Ox26a.createRange().parentElement();} ;return Ox26a.createRange().item(0);} ;var Ox26a=Ox2d4.getSelection();if(Window_GetSelectionType(Ox2d4)==OxO1dde[10]){return Ox26a[OxO1dde[13]][OxO1dde[12]][Ox26a[OxO1dde[11]]];} ;if(Ox26a[OxO1dde[14]]){return Ox26a[OxO1dde[13]];} ;if(Ox26a[OxO1dde[13]]==Ox26a[OxO1dde[15]]){return Ox26a[OxO1dde[13]];} ;var p=Ox26a[OxO1dde[13]];var Oxc=p[OxO1dde[12]];for(var i=0;i<Oxc[OxO1dde[16]];i++){var Ox370=Oxc.item(i);if(Ox26a.containsNode(Ox370,true)){if(i!=0&&Ox26a.containsNode(Oxc.item(i-1),false)){continue ;} ;if(i<Oxc[OxO1dde[16]]-1&&Ox26a.containsNode(Oxc.item(i+1),false)){continue ;} ;return Ox370;} ;} ;if(Ox26a[OxO1dde[8]]==1){return Range_GetParentNode(Window_CreateSelectionRange(Ox2d4));} ;if(!Element_Contains(Ox2d4[OxO1dde[3]].body,Ox26a.anchorNode)){return null;} ;return Element_GetSameParent(Ox26a.anchorNode,Ox26a.focusNode);} ;function Window_GetSelectionElement(Ox2d4){var Ox2ad=Window_GetSelectionNode(Ox2d4);if(Ox2ad==null){return null;} ;if(Ox2ad[OxO1dde[17]]==1){return Ox2ad;} ;return Ox2ad[OxO1dde[1]];} ;function Window_GetSelectionType(Ox2d4){if(Browser_UseIESelection()){return Ox2d4[OxO1dde[3]][OxO1dde[2]][OxO1dde[4]];} ;var Ox26a=Ox2d4.getSelection();if(Ox26a[OxO1dde[14]]){return OxO1dde[6];} ;if(Ox26a[OxO1dde[13]]!=Ox26a[OxO1dde[15]]){return OxO1dde[6];} ;var p=Ox26a[OxO1dde[13]];var Oxc=p[OxO1dde[12]];for(var i=0;i<Oxc[OxO1dde[16]];i++){var Ox370=Oxc.item(i);if(Ox370[OxO1dde[17]]!=1){continue ;} ;if(Ox26a.containsNode(Ox370,true)){if(i!=0&&Ox26a.containsNode(Oxc.item(i-1),false)){continue ;} ;if(i<Oxc[OxO1dde[16]]-1&&Ox26a.containsNode(Oxc.item(i+1),false)){continue ;} ;if(Element_IsBlockControl(Ox370)){return OxO1dde[10];} ;return OxO1dde[6];} ;} ;return OxO1dde[6];} ;function Element_IsBlockControl(element){var name=element[OxO1dde[18]];if(name==OxO1dde[19]){return true;} ;if(name==OxO1dde[20]){return true;} ;if(name==OxO1dde[21]){return true;} ;if(name==OxO1dde[22]){return true;} ;if(name==OxO1dde[23]){return true;} ;if(name==OxO1dde[24]){return true;} ;var Ox239=element[OxO1dde[26]][OxO1dde[25]];if(Ox239==OxO1dde[27]||Ox239==OxO1dde[28]){return true;} ;return false;} ;function Window_GetDialogTop(Ox2d4){return Ox2d4[OxO1dde[29]];} ;function Frame_GetContentWindow(Ox47d){if(Ox47d[OxO1dde[30]]){return Ox47d[OxO1dde[30]];} ;if(Ox47d[OxO1dde[31]]){if(Ox47d[OxO1dde[31]][OxO1dde[32]]){return Ox47d[OxO1dde[31]][OxO1dde[32]];} ;} ;var Ox2d4;if(Ox47d[OxO1dde[33]]){Ox2d4=window[OxO1dde[34]][Ox47d[OxO1dde[33]]];if(Ox2d4){return Ox2d4;} ;} ;var len=window[OxO1dde[34]][OxO1dde[16]];for(var i=0;i<len;i++){Ox2d4=window[OxO1dde[34]][i];if(Ox2d4[OxO1dde[35]]==Ox47d){return Ox2d4;} ;if(Ox2d4[OxO1dde[3]]==Ox47d[OxO1dde[31]]){return Ox2d4;} ;} ;Debug_Todo(OxO1dde[36]);} ;var iframe=Window_GetElement(window,OxO1dde[37],true);var iframe_win=Frame_GetContentWindow(iframe);var obj=Window_GetDialogArguments(window);var editor=obj[OxO1dde[38]];var editwin=obj[OxO1dde[9]];var editdoc=obj[OxO1dde[3]];var oImg=obj[OxO1dde[39]];var oMap=null;var aMapName= new Array();var aLeft= new Array();var aTop= new Array();var aWidth= new Array();var aHeight= new Array();var aHref= new Array();var aTarget= new Array();var aTitle= new Array();var aCoords= new Array();window[OxO1dde[40]]=function window_onload(){var src;src=oImg.getAttribute(OxO1dde[41])+OxO1dde[42];if(oImg.getAttribute(OxO1dde[43])){src=oImg.getAttribute(OxO1dde[43])+OxO1dde[42];} ;oImg[OxO1dde[41]]=src;if(Browser_IsWinIE()){iframe_win[OxO1dde[3]][OxO1dde[7]][OxO1dde[44]]=true;} else {iframe_win[OxO1dde[3]][OxO1dde[45]]=OxO1dde[46];iframe_win[OxO1dde[3]][OxO1dde[7]][OxO1dde[44]]=true;} ;iframe_win[OxO1dde[3]][OxO1dde[7]][OxO1dde[47]];iframe_win[OxO1dde[3]][OxO1dde[7]][OxO1dde[26]][OxO1dde[48]]=OxO1dde[49];iframe_win[OxO1dde[3]][OxO1dde[7]][OxO1dde[26]][OxO1dde[50]]=OxO1dde[49];iframe_win[OxO1dde[3]][OxO1dde[7]][OxO1dde[26]][OxO1dde[51]]=OxO1dde[52];iframe_win[OxO1dde[3]][OxO1dde[7]][OxO1dde[26]][OxO1dde[53]]=OxO1dde[54];oImg[OxO1dde[55]]=OxO1dde[46];if(Browser_IsWinIE()){iframe_win[OxO1dde[3]].execCommand(OxO1dde[56],true,true);iframe_win[OxO1dde[3]].execCommand(OxO1dde[57],true,true);} ;iframe_win.focus();if(Browser_IsWinIE()){iframe_win[OxO1dde[3]][OxO1dde[7]][OxO1dde[58]]=oImg[OxO1dde[59]];} else {iframe_win[OxO1dde[3]][OxO1dde[7]][OxO1dde[58]]=outerHTML(oImg);} ;var Ox48b=editdoc[OxO1dde[7]].getElementsByTagName(OxO1dde[60]);for(var i=0;i<Ox48b[OxO1dde[16]];i++){aMapName[i]=Ox48b[i][OxO1dde[61]].toUpperCase();} ;var Ox48c=oImg[OxO1dde[62]];if(Ox48c!=OxO1dde[42]){Ox48c=Ox48c.toUpperCase();for(var i=0;i<Ox48b[OxO1dde[16]];i++){if((OxO1dde[63]+aMapName[i])==Ox48c){oMap=Ox48b[i];} ;} ;} ;if(oMap){for(var i=0;i<oMap[OxO1dde[64]][OxO1dde[16]];i++){aHref[i]=oMap[OxO1dde[64]][i][OxO1dde[65]];aTarget[i]=oMap[OxO1dde[64]][i][OxO1dde[66]];aTitle[i]=oMap[OxO1dde[64]][i][OxO1dde[67]];aCoords[i]=oMap[OxO1dde[64]][i][OxO1dde[68]];var Ox1b=aCoords[i].split(OxO1dde[69]);aLeft[i]=parseInt(Ox1b[0]);aTop[i]=parseInt(Ox1b[1]);aWidth[i]=parseInt(Ox1b[2])-aLeft[i];aHeight[i]=parseInt(Ox1b[3])-aTop[i];iframe_win[OxO1dde[3]][OxO1dde[7]][OxO1dde[58]]+=OxO1dde[70]+i+OxO1dde[71]+AddLinktoImageMap+OxO1dde[72]+aLeft[i]+OxO1dde[73]+aTop[i]+OxO1dde[74]+aWidth[i]+OxO1dde[75]+aHeight[i]+OxO1dde[76]+(i+1)+OxO1dde[77];} ;} ;} ;function SearchSelectionElement(Ox48e){var body=iframe_win[OxO1dde[3]][OxO1dde[7]];for(var Ox283=Window_GetSelectionElement(iframe_win);Element_Contains(body,Ox283);Ox283=Ox283[OxO1dde[1]]){if(Ox283[OxO1dde[18]]==Ox48e){return Ox283;} ;} ;return null;} ;function Addlink(){var img=SearchSelectionElement(OxO1dde[22]);if(!img){return ;} ;function Ox492(arr){if(arr){aHref[Ox494]=arr[0];aTarget[Ox494]=arr[1];aTitle[Ox494]=arr[2];} ;} ;var Ox493=img[OxO1dde[33]];var Ox494=parseInt(Ox493.substr(7));var obj={editor:editor,href:aHref[Ox494],target:aTarget[Ox494],title:aTitle[Ox494]};editor.SetNextDialogWindow(window);editor.ShowDialog(Ox492,OxO1dde[78]+query_string,obj,OxO1dde[79]);} ;function do_Close(){Window_SetDialogReturnValue(window,null);Window_CloseDialog(window);} ;function Zoom_In(){if(iframe_win[OxO1dde[3]][OxO1dde[7]][OxO1dde[26]][OxO1dde[80]]!=0){iframe_win[OxO1dde[3]][OxO1dde[7]][OxO1dde[26]][OxO1dde[80]]*=1.2;} else {iframe_win[OxO1dde[3]][OxO1dde[7]][OxO1dde[26]][OxO1dde[80]]=1.2;} ;} ;function Zoom_Out(){if(iframe_win[OxO1dde[3]][OxO1dde[7]][OxO1dde[26]][OxO1dde[80]]!=0){iframe_win[OxO1dde[3]][OxO1dde[7]][OxO1dde[26]][OxO1dde[80]]*=0.8;} else {iframe_win[OxO1dde[3]][OxO1dde[7]][OxO1dde[26]][OxO1dde[80]]=0.8;} ;} ;function BestFit(){if(!oImg){return ;} ;var Ox498=280;var Ox27d=290;iframe_win[OxO1dde[3]][OxO1dde[7]][OxO1dde[26]][OxO1dde[80]]=1/Math.max(oImg[OxO1dde[81]]/Ox27d,oImg[OxO1dde[82]]/Ox498);} ;function Actualsize(){iframe_win[OxO1dde[3]][OxO1dde[7]][OxO1dde[26]][OxO1dde[80]]=1;} ;function newMap(){var Ox248=aHref[OxO1dde[16]];var Ox49b=(oImg[OxO1dde[81]]-20)*0.5;var Ox46f=(oImg[OxO1dde[82]]-20)*0.5;aHref[Ox248]=OxO1dde[42];aTarget[Ox248]=OxO1dde[42];aTitle[Ox248]=OxO1dde[42];iframe_win[OxO1dde[3]][OxO1dde[7]][OxO1dde[58]]+=OxO1dde[70]+Ox248+OxO1dde[83]+AddLinktoImageMap+OxO1dde[84]+(Ox248+1)+OxO1dde[85]+Ox49b+OxO1dde[86]+Ox46f+OxO1dde[77];iframe_win.scrollBy(0,0);iframe_win.focus();} ;function do_insert(){var Ox1c=false;for(var i=0;i<aHref[OxO1dde[16]];i++){var obj=Window_GetElement(iframe_win,OxO1dde[87]+i,false);if(obj){Ox1c=true;} ;} ;if(Ox1c){var Ox3b1=OxO1dde[42];for(var i=0;i<aHref[OxO1dde[16]];i++){var obj=Window_GetElement(iframe_win,OxO1dde[87]+i,false);if(obj){var Ox49c=parseInt(obj[OxO1dde[26]].left);var Ox49d=parseInt(obj[OxO1dde[26]].top);var Ox49e=parseInt(obj[OxO1dde[26]].width);var Ox49f=parseInt(obj[OxO1dde[26]].height);var Ox4a0=Ox49c+Ox49e;var Ox4a1=Ox49d+Ox49f;Ox3b1+=OxO1dde[88]+Ox49c+OxO1dde[69]+Ox49d+OxO1dde[69]+Ox4a0+OxO1dde[69]+Ox4a1+OxO1dde[89];if(aHref[i]!=OxO1dde[42]){Ox3b1+=OxO1dde[90]+aHref[i]+OxO1dde[91];} ;if((aTarget[i]!=OxO1dde[42])&&aTarget[i]){Ox3b1+=OxO1dde[92]+aTarget[i]+OxO1dde[91];} ;if(aTitle[i]!=OxO1dde[42]&&aTitle[i]!=null){Ox3b1+=OxO1dde[93]+aTitle[i]+OxO1dde[91];} ;Ox3b1+=OxO1dde[94];} ;} ;if(oMap){oMap[OxO1dde[58]]=Ox3b1;} else {var Ox48c=getAutoMapName();oImg[OxO1dde[62]]=OxO1dde[63]+Ox48c;editor.ExecCommand(OxO1dde[95],false,OxO1dde[96]+Ox48c+OxO1dde[77]+Ox3b1+OxO1dde[97]);} ;} else {if(oMap){if(Browser_IsWinIE()){oMap[OxO1dde[59]]=OxO1dde[42];} ;} ;oImg[OxO1dde[62]]=OxO1dde[42];} ;oImg[OxO1dde[55]]=OxO1dde[98];oImg.removeAttribute(OxO1dde[55]);if(!Browser_IsWinIE()){editor.InsertElement(oImg);} ;Window_CloseDialog(window);} ;function getAutoMapName(){for(var i=1;true;i++){var Ox1ff=OxO1dde[99]+i;if(isValidMapName(Ox1ff)){return Ox1ff;} ;} ;} ;function isValidMapName(Oxb){Oxb=Oxb.toUpperCase();for(var i=0;i<aMapName[OxO1dde[16]];i++){if(aMapName[i]==Oxb){return false;} ;} ;return true;} ;function do_Close(){oImg.removeAttribute(OxO1dde[55]);Window_CloseDialog(window);} ;if(!Browser_IsWinIE()){Window_GetElement(window,OxO1dde[101],true)[OxO1dde[26]][OxO1dde[100]]=OxO1dde[102];Window_GetElement(window,OxO1dde[103],true)[OxO1dde[26]][OxO1dde[100]]=OxO1dde[102];Window_GetElement(window,OxO1dde[104],true)[OxO1dde[26]][OxO1dde[100]]=OxO1dde[102];Window_GetElement(window,OxO1dde[105],true)[OxO1dde[26]][OxO1dde[100]]=OxO1dde[102];} ;